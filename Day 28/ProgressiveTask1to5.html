<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Progrssive task 1 to 5</title>

  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    h2{
        text-align: center;
        color: red;
    }
    .hover-highlight {
      transition: background-color 0.3s;
    }
    .hover-highlight:hover {
      background-color: lightsalmon;
    }
  </style>
</head>
<body class="bg-light">
  <main class="container py-5">

    <h2 id="main-title" class="mb-3" style="align-self: auto;">Product Showcase</h2>

    <p class="text-muted">
      Products created using JavaScript classes, objects, methods, inheritance, and array methods (forEach, filter, reduce).
    </p>

    <div class="mb-4 d-flex gap-2">
      <button id="change-title-btn" class="btn btn-primary btn-sm">
        Change Page Title
      </button>
      <button id="toggle-bg-btn" class="btn btn-outline-secondary btn-sm">
        Toggle Background Color
      </button>
    </div>

    <div id="product-list" class="row g-4 mb-5"></div>

    <section id="store-section" class="hover-highlight p-3 rounded">
      <h3 id="store-title" class="mb-3">Store Items (Array Methods)</h3>

      <div class="row">
        <div class="col-md-6">
          <h5>All items</h5>
          <ul id="all-items" class="list-group mb-3"></ul>
        </div>

        <div class="col-md-6">
          <h5>Items with price &lt; ₹500</h5>
          <ul id="filtered-items" class="list-group mb-3"></ul>

          <h5>Total price of all items</h5>
          <p id="total-price" class="fw-semibold text-primary"></p>
        </div>
      </div>
    </section>

    <section class="mt-4">
      <h4 class="mb-2">Add Note (Form Event)</h4>
      <form id="note-form" class="row gy-2 gx-2 align-items-center">
        <div class="col-sm-8">
          <input
            type="text"
            id="note-input"
            class="form-control"
            placeholder="Write a short note..."
          />
          <!-- input validation error message -->
          <div id="note-error" class="text-danger small mt-1"></div>
        </div>
        <div class="col-sm-4">
          <button type="submit" class="btn btn-success w-100">
            Save Note
          </button>
        </div>
      </form>
      <p id="note-output" class="mt-2 text-muted"></p>
    </section>
  </main>

  <script>
    // ---------------------- DATA & CLASSES ----------------------
    const productData = [
      {
        name: "Pro Landing Template",
        price: 1499,
        description: "High-converting landing page for startups."
      },
      {
        name: "Ecommerce UI Kit",
        price: 1999,
        description: "Product cards, filters, and checkout screens."
      },
      {
        name: "Analytics Dashboard",
        price: 2499,
        description: "Dashboard with cards, charts, and KPIs."
      }
    ];

    class Product {
      constructor(name, price, description) {
        this.name = name;
        this.price = price;
        this.description = description;
      }

      discountedPrice(discountPercent = 10) {
        const discountAmount = (this.price * discountPercent) / 100;
        return this.price - discountAmount;
      }

      displayProduct() {
        console.log(`${this.name} - ₹${this.price}`);
        console.log(this.description);
        console.log(`Discounted (10%): ₹${this.discountedPrice(10)}`);
        console.log("----");
      }
    }

    class DigitalProduct extends Product {
      constructor(name, price, description, fileSizeMB, downloadLink) {
        super(name, price, description);
        this.fileSizeMB = fileSizeMB;
        this.downloadLink = downloadLink;
      }

      displayProduct() {
        console.log(`${this.name} (Digital) - ₹${this.price}`);
        console.log(this.description);
        console.log(`Size: ${this.fileSizeMB} MB`);
        console.log(`Download: ${this.downloadLink}`);
        console.log(`Discounted (10%): ₹${this.discountedPrice(10)}`);
        console.log("----");
      }

      getDownloadInfo() {
        return `Download ${this.name} (${this.fileSizeMB} MB) from ${this.downloadLink}`;
      }
    }

    const products = productData.map(
      item => new Product(item.name, item.price, item.description)
    );

    const digitalLanding = new DigitalProduct(
      "Pro Landing Template (Digital)",
      1499,
      "Bootstrap landing page with sections ready to use.",
      12,
      "https://example.com/download/landing"
    );
    products.push(digitalLanding);

    products.forEach(p => p.displayProduct());
    console.log(digitalLanding.getDownloadInfo());

    const productListEl = document.getElementById("product-list");

    // Guard: handle missing product list element
    if (!productListEl) {
      console.warn("product-list element not found; skipping product rendering.");
    } else {
      products.forEach(product => {
        const col = document.createElement("div");
        col.className = "col-md-4";

        const isDigital = product instanceof DigitalProduct;

        col.innerHTML = `
          <div class="card shadow-sm h-100 hover-highlight">
            <div class="card-body">
              <h5 class="card-title">
                ${product.name}
                ${
                  isDigital
                    ? '<span class="badge bg-info ms-1">Digital</span>'
                    : ""
                }
              </h5>
              <p class="card-text mb-1">${product.description}</p>
              ${
                isDigital
                  ? `
                      <p class="card-text mb-1 text-muted small">
                        File size: ${product.fileSizeMB} MB
                      </p>
                    `
                  : ""
              }
              <p class="card-text fw-semibold mb-1">Price: ₹${product.price}</p>
              <p class="card-text text-success small mb-0">
                Discounted (10%): ₹${product.discountedPrice(10).toFixed(0)}
              </p>
              ${
                isDigital
                  ? `<a href="${product.downloadLink}" class="btn btn-sm btn-primary mt-2">
                       Download
                     </a>`
                  : ""
              }
            </div>
          </div>
        `;

        productListEl.appendChild(col);
      });
    }

    
    const storeItems = [
      { name: "Pen", price: 30 },
      { name: "Notebook", price: 120 },
      { name: "USB Cable", price: 250 },
      { name: "Mouse Pad", price: 350 },
      { name: "Headphones", price: 999 },
      { name: "Laptop Stand", price: 1299 }
    ];

    const allItemsEl = document.getElementById("all-items");
    const filteredItemsEl = document.getElementById("filtered-items");
    const totalPriceEl = document.getElementById("total-price");

    function safeRenderList(array, ulElement) {
      if (!ulElement) {
        console.warn("renderList: target UL element is missing.");
        return;
      }
      ulElement.innerHTML = "";
      array.forEach(item => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          <span>${item.name}</span>
          <span class="badge bg-secondary rounded-pill">₹${item.price}</span>
        `;
        ulElement.appendChild(li);
      });
    } 

    safeRenderList(storeItems, allItemsEl);

    const cheapItems = storeItems.filter(item => item.price < 500);
    safeRenderList(cheapItems, filteredItemsEl);

    if (totalPriceEl) {
      const totalPrice = storeItems.reduce((sum, item) => sum + item.price, 0);
      totalPriceEl.textContent = `Total price of all items: ₹${totalPrice}`;
    }

   
    const mainTitle = document.getElementById("main-title");
    const storeTitle = document.querySelector("#store-section h3");
    const changeTitleBtn = document.getElementById("change-title-btn");

    if (changeTitleBtn && mainTitle && storeTitle) {
      changeTitleBtn.addEventListener("click", () => {
        mainTitle.textContent = "Interactive Product Showcase";
        storeTitle.textContent = "Store Items (Updated with JS)";
      });
    }

    const toggleBgBtn = document.getElementById("toggle-bg-btn");
    let isAltBg = false;

    if (toggleBgBtn) {
      toggleBgBtn.addEventListener("click", () => {
        if (!isAltBg) {
          document.body.classList.remove("bg-light");
          document.body.style.backgroundColor = "Pink";
          isAltBg = true;
          toggleBgBtn.textContent = "Reset Background";
        } else {
          document.body.style.backgroundColor = "";
          document.body.classList.add("bg-light");
          isAltBg = false;
          toggleBgBtn.textContent = "Toggle Background Color";
        }
      });
    }

   
    const mainEl = document.querySelector("main");

    if (mainEl) {
      const extraSection = document.createElement("section");
      extraSection.className = "mt-5";

      extraSection.innerHTML = `
        <h3 class="mb-3">Extra Projects (Added with JS)</h3>
        <p class="text-muted mb-2">
          This section was created dynamically using <code>document.createElement</code> and <code>appendChild()</code>.
        </p>
        <ul id="extra-projects" class="list-group">
          <li class="list-group-item">Portfolio Website Template</li>
          <li class="list-group-item">Admin Dashboard Layout</li>
        </ul>
      `;

      mainEl.appendChild(extraSection);
    }

  
    const noteForm = document.getElementById("note-form");
    const noteInput = document.getElementById("note-input");
    const noteOutput = document.getElementById("note-output");
    const noteError = document.getElementById("note-error");

    if (noteForm && noteInput && noteOutput && noteError) {
     
      noteForm.addEventListener("submit", (event) => {
        event.preventDefault();

        const value = noteInput.value.trim();
        noteError.textContent = "";

        if (!value) {
          noteError.textContent = "Note cannot be empty.";
          noteOutput.textContent = "";
          noteOutput.classList.remove("text-success");
          noteOutput.classList.add("text-muted");
          return;
        }

        if (value.length < 3) {
          noteError.textContent = "Note must be at least 3 characters.";
          noteOutput.textContent = "";
          return;
        } 

        // try–catch in case something unexpected fails (future‑proofing)
        try {
          noteOutput.textContent = `Saved note: ${value}`;
          noteOutput.classList.remove("text-danger", "text-muted");
          noteOutput.classList.add("text-success");
          noteInput.value = "";
        } catch (err) {
          console.error("Error while saving note:", err);
          noteOutput.textContent = "Something went wrong while saving the note.";
          noteOutput.classList.remove("text-success");
          noteOutput.classList.add("text-danger");
        } 
      });
    } else {
      console.warn("Note form elements missing; form logic not attached.");
    }

   
    const storeSection = document.getElementById("store-section");
    if (storeSection) {
      storeSection.addEventListener("mouseover", () => {
        storeSection.style.boxShadow = "0 0 0 0.2rem rgba(13,110,253,.15)";
      });
      storeSection.addEventListener("mouseout", () => {
        storeSection.style.boxShadow = "none";
      });
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
